function init(){setNavigationForAboutUsButton(),slideLandingPage(),rateComment(),dateFormat(document),showHideDropdownMenu(),addOpinionButtonAction(),addFunctionPostComment(),addFunctionDestroyComment(),addFunctionEditComment()}function setNavigationForAboutUsButton(){aboutUsButton.addEventListener("click",function(){this.classList.add("collapse__buttons--active")})}function slideLandingPage(){getStartedButton.on("click",hideLandingpage),$(window).one("scroll",hideLandingpage)}function hideLandingpage(){getStartedButton.removeClass("pulse"),landpage.addClass("landpage--hidden"),aboutUsButton.classList.add("collapse__buttons--active")}function rateComment(){function t(t){stars[t].innerHTML="&#9733;",stars[t].classList.add("new-comment-form__rate--hover")}for(let e=0;e<starsQuantity;e++)stars[e].addEventListener("click",function(){clickedStar=this.getAttribute("value"),document.querySelector("#rateNum").setAttribute("value",clickedStar),resetStars();for(let e=0;e<clickedStar;e++)t(e)}),stars[e].addEventListener("mouseenter",function(){resetStars();for(let e=0;e<this.getAttribute("value");e++)t(e)}),stars[e].addEventListener("mouseleave",()=>{resetStars();for(let e=0;e<clickedStar;e++)t(e)})}function dateFormat(t){let e=t.querySelectorAll(".content__date"),n=Date.now();for(let t=0,o=e.length;t<o;t++){let o=new Date(e[t].innerText),a=o.getMinutes(),r=`${o.getHours()}:${a<10?"0":""}${a}`,i=o.getTime(),s=Math.floor((n-i)/864e5);e[t].innerText=s<=1?`Dziś o ${r}`:s<=2?`Wczoraj o ${r}`:s<=30?`${s} dni temu`:`${o.getDate()} ${months[o.getMonth()]}`,$(e[t]).show(0)}}function showHideDropdownMenu(t){let e=t?$(t):$(document.querySelectorAll(".content__dropdown-wrapper")),n=e.find(".dropdown-wrapper__menu");e.each(function(){$(this).off().on("click",()=>{let t=$(this).find(".dropdown-wrapper__menu");n.not(t).removeClass("visibility--visible"),t.toggleClass("visibility--visible")})}),$(document).on("click",t=>{$(t.target).closest(".content__dropdown-wrapper").length||n.removeClass("visibility--visible")})}function addOpinionButtonAction(){document.getElementById("button-addOpinion").addEventListener("click",function(){this.classList.add("visibility--hidden"),document.getElementById("comment-form-wrapper").classList.add("container__new-comment-form-wrapper--visible"),scrollToObjective(commentFormWrap)})}function addFunctionPostComment(){$("#button-sendOpinion").click(()=>{let t={numOfStars:form.find("#rateNum").val(),commentText:form.find("#text").val(),commentAvatar:form.find("#avatar").val(),commentAuthor:form.find("#currentuser").val()};t.numOfStars&&t.commentText&&postCommentToDatabase(t)})}function postCommentToDatabase(t){$.ajax({type:"POST",url:"http://localhost:3000/",data:t,headers:{"X-Requested-With":"XMLHttpRequest"},success:e=>{t.commentId=e,form[0].reset(),resetStars(),clickedStar=0,displayPostedComment(t),scrollToObjective(commentFormWrap),addFunctionDestroyComment(),addFunctionEditComment()},error:error})}function displayPostedComment(t){let e="",n=$("#commentHiddenTemplate").children().clone()[0];for(let n=0;n<t.numOfStars;n++)e+="&#9733;";n.getElementsByTagName("img")[0].setAttribute("src",t.commentAvatar),n.getElementsByClassName("content__author")[0].innerText=t.commentAuthor,n.getElementsByClassName("content__rate")[0].innerHTML=e,n.getElementsByClassName("content__text")[0].innerText=t.commentText,n.getElementsByClassName("content__date")[0].innerText=Date(),$(n.getElementsByClassName("button-DeleteComment")[0]).parent().attr("data",t.commentId),dateFormat(n),$(n.outerHTML).appendTo("#comments-wrapper"),showHideDropdownMenu(document.querySelectorAll(".content__dropdown-wrapper"))}function addFunctionDestroyComment(){$(".button-DeleteComment").each(function(){$(this).on("click",()=>{let t={commentId:$.trim($(this).parent().attr("data"))};$.ajax({url:"http://localhost:3000/",data:t,type:"DELETE",success:()=>{$(this).closest(".comments-wrapper__comment").remove()},error:error})})})}function addFunctionEditComment(){let t=$(".button-EditComment"),e=$(document.querySelectorAll(".dropdown-wrapper__button"));t.each(function(){$(this).on("click",()=>{let t={commentId:$.trim($(this).parent().attr("data"))},n=$(this).closest("div.comment__content"),o=n.find("div.content__text"),a=o.text().trim(),r=`<form id='edit-form' class='content__edit-form'>\n                        <textarea id='text-area' class='edit-form__textarea'>${a}</textarea>\n                        <div class='edit-form__buttons-container'>\n                          <button type='button' id='buttonAccept' class='button button--small button--accept'>Zatwierdź</button>\n                          <button type='button' id='buttonCancel' class='button button--small button--cancel'>Anuluj</button>\n                        </div>\n                      </form>`;e.addClass("display--none"),o.replaceWith(r).promise().done(()=>{let r=n.find("#edit-form");n.find("#buttonAccept").on("click",()=>{t.editFormText=r.find("#text-area").val();let n=o.text(t.editFormText),i={editForm:r,newTextDiv:n,btnToggleDropdown:e};t.editFormText!==a&&updateCommentToDatabase(t,i)}),n.find("#buttonCancel").on("click",()=>{r.replaceWith(o),e.removeClass("display--none")})})})})}function updateCommentToDatabase(t,e){$.ajax({type:"PUT",url:"http://localhost:3000/",data:t,headers:{"X-Requested-With":"XMLHttpRequest"},success:()=>{displayEditedComment(e)},error:error})}function displayEditedComment(t){t.editForm.replaceWith(t.newTextDiv),t.btnToggleDropdown.removeClass("display--none")}function error(t,e,n){console.log("Error")}function scrollToObjective(t,e=800){$("body,html").animate({scrollTop:t.offset().top},e)}function resetStars(){for(let t=0;t<starsQuantity;t++)stars[t].innerHTML="&#9734;",stars[t].classList.remove("new-comment-form__rate--hover")}const stars=document.querySelectorAll("#rate span"),starsQuantity=stars.length,form=$("#comment-form"),landpage=$("#landpage"),aboutUsButton=document.getElementById("aboutUsButton"),getStartedButton=$("#button-getStarted"),commentFormWrap=$("#comment-form-wrapper"),months=["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","września","października","listopada","grudnia"];var clickedStar=0;init();